<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Atlas.UI.ViewModels"
             xmlns:models="using:Atlas.UI.Models"
             x:Class="Atlas.UI.Views.TeamView"
             x:DataType="vm:TeamViewModel">

    <Grid ColumnDefinitions="240,*,300" ColumnSpacing="16">
        <!-- Members list -->
        <Border Grid.Column="0" Classes="card" Padding="12">
            <StackPanel Spacing="10">
                <TextBlock Text="Team" FontSize="14" FontWeight="SemiBold"/>
                <ListBox ItemsSource="{Binding Members}"
                         SelectedItem="{Binding SelectedMember}"
                         Background="Transparent"
                         BorderThickness="0">
                    <ListBox.ItemTemplate>
                        <DataTemplate x:DataType="models:TeamMember">
                            <Border BorderBrush="{DynamicResource AppBorderBrush}" BorderThickness="0,0,0,1" Padding="0,10">
                                <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                    <Ellipse Width="28" Height="28" Fill="{DynamicResource AppPanelBackgroundAltBrush}"/>
                                    <StackPanel Grid.Column="1" Spacing="2">
                                        <TextBlock Text="{Binding Name}"/>
                                        <TextBlock Classes="secondary" FontSize="12" Text="{Binding CurrentFocus}"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Border>

        <!-- Member detail -->
        <Border Grid.Column="1" Classes="card" Padding="12">
            <ScrollViewer>
                <StackPanel Spacing="12">
                    <TextBlock Text="{Binding SelectedMember.Name}" FontSize="16" FontWeight="SemiBold"/>
                    <TextBox Watermark="Current Focus" Text="{Binding SelectedMember.CurrentFocus}"/>

                    <Border Classes="card" Background="{DynamicResource AppPanelBackgroundAltBrush}" Padding="12">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Performance Notes" FontSize="14" FontWeight="SemiBold"/>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBox Width="260" Watermark="Quick note…" Text="{Binding QuickNoteText}"/>
                                <Button Classes="primary" Content="Add" Command="{Binding AddQuickNoteCommand}"/>
                            </StackPanel>

                            <StackPanel Spacing="8">
                                <TextBlock Text="Structured note" Classes="secondary"/>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <ComboBox Width="160" SelectedItem="{Binding SelectedTag}">
                                        <ComboBoxItem Content="Blocker"/>
                                        <ComboBoxItem Content="Progress"/>
                                        <ComboBoxItem Content="Concern"/>
                                        <ComboBoxItem Content="Praise"/>
                                        <ComboBoxItem Content="Standup"/>
                                    </ComboBox>
                                    <Button Content="Add" Command="{Binding AddStructuredNoteCommand}"/>
                                </StackPanel>
                                <TextBox AcceptsReturn="True" MinHeight="80" Watermark="Note…" Text="{Binding StructuredNoteText}"/>
                            </StackPanel>

                            <ItemsControl ItemsSource="{Binding SelectedMember.Notes}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="models:PerformanceNote">
                                        <Border BorderBrush="{DynamicResource AppBorderBrush}" BorderThickness="0,0,0,1" Padding="0,10">
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="{Binding When}"/>
                                                <TextBlock Classes="secondary" Text="{Binding Tag}"/>
                                                <TextBlock Text="{Binding Text}"/>
                                                <TextBlock Classes="secondary" Text="{Binding LinkLabel}"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- ADO item peek -->
        <Border Grid.Column="2" Classes="card" Padding="12">
            <StackPanel Spacing="10">
                <TextBlock Text="Azure DevOps Items" FontSize="14" FontWeight="SemiBold"/>
                <ItemsControl ItemsSource="{Binding SelectedMember.WorkItems}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="models:AzureWorkItem">
                            <Border BorderBrush="{DynamicResource AppBorderBrush}" BorderThickness="0,0,0,1" Padding="0,10">
                                <StackPanel Spacing="2">
                                    <TextBlock Text="{Binding Id}"/>
                                    <TextBlock Text="{Binding Title}"/>
                                    <TextBlock Classes="secondary" FontSize="12" Text="{Binding Status}"/>
                                    <TextBlock Classes="secondary" FontSize="12" Text="{Binding TimeTaken}"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                <Button Content="Open in browser" IsEnabled="False"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>


